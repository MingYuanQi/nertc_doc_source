<!--keywords:音视频通话,摄像头切换,闪光灯,对焦,曝光 -->

在各种视频的业务场景中，用户经常会需要调整设备的摄像头，例如调整曝光、对焦和闪光灯等功能设置，使被摄物体成像清晰、亮度适宜。 NERTC SDK 提供整套的摄像头管理方法，以便用户灵活切换前置摄像头、后置摄像头，并对摄像头进行缩放、对焦和曝光等相关配置。

## 功能介绍

NERTC SDK 提供相关接口，支持检测拍摄相关设备的能力，例如检测是否支持闪光灯常开等。同时支持多种摄像头相关的设置方法，包括：
- 摄像头相关：
    - 摄像头缩放：支持动态调整缩放比例。
    - 摄像头切换：支持切换或指定前后置摄像头。
- 闪光灯：支持开关闪光灯。
- 对焦：支持手动选择对焦位置，摄像头自动对焦。
- 曝光：支持手动选择曝光区域，摄像头自动曝光。

## 注意事项

- 部分设备可能不支持开启闪光灯或摄像头缩放，直接调用接口调节设备可能会失败。因此用户操作前应先调用相关检测接口，判断当前设备是否支持调整设备的相关设置。
- 请在相机启用后再调用视频设备相关的设置方法，例如在调用 <a href="https://doc.yunxin.163.com/nertc/api-refer/android/doxygen/Latest/zh/html/classcom_1_1netease_1_1lava_1_1nertc_1_1sdk_1_1_n_e_rtc.html#afbf7f0de6fdd33a63d9f8bb60031e5f8" target="_blank">`startVideoPreview`</a> 方法或 <a href="https://doc.yunxin.163.com/nertc/api-refer/android/doxygen/Latest/zh/html/classcom_1_1netease_1_1lava_1_1nertc_1_1sdk_1_1_n_e_rtc.html#a2a44081baf4bd457749d1c48cd2def36" target="_blank">`joinChannel`</a> 方法后。

## 示例项目源码
网易云信提供[设备管理的示例项目源码 DeviceManagement](https://github.com/netease-im/G2-API-Examples/tree/main/android/Advance/DeviceManagement) ，您可以参考该源码实现视频设备管理。

## 摄像头缩放

### 配置步骤

1. 调用 [`isCameraZoomSupported`](https://doc.yunxin.163.com/nertc/api-refer/android/doxygen/Latest/zh/html/classcom_1_1netease_1_1lava_1_1nertc_1_1sdk_1_1_n_e_rtc_ex.html#ab91298d417a68719435a2ae0975a72df)，检测设备是否支持摄像头缩放功能。
2. 调用 [`setCameraZoomFactor`](https://doc.yunxin.163.com/nertc/api-refer/android/doxygen/Latest/zh/html/classcom_1_1netease_1_1lava_1_1nertc_1_1sdk_1_1_n_e_rtc_ex.html#a6395a6b5ff8aaf426740c7e000396195) 方法设置具体需要的缩放比例，可在通话过程中动态调整。

    ::: note note
    在设置需要的摄像头缩放比例前，您可以调用 [`getCameraMaxZoom`](https://doc.yunxin.163.com/nertc/api-refer/android/doxygen/Latest/zh/html/classcom_1_1netease_1_1lava_1_1nertc_1_1sdk_1_1_n_e_rtc_ex.html#af70333b0d6d69f57e8809ec1cae16491) 方法获取设备支持的最大缩放比例或调用 [`getCameraCurrentZoom`](https://doc.yunxin.163.com/nertc/api-refer/android/doxygen/Latest/zh/html/classcom_1_1netease_1_1lava_1_1nertc_1_1sdk_1_1_n_e_rtc_ex.html#a61177c0fb8a4521ce1fa0169066af60e) 方法获取摄像头当前的缩放比例。
    :::
    
### 示例代码

```
//检测设备是否支持摄像头缩放
NERtcEx.getInstance().isCameraZoomSupported();

//获取设备支持的最大缩放比例
NERtcEx.getInstance().getCameraMaxZoom();

// 设置摄像头缩放比例
int curZoom = NERtcEx.getInstance().getCameraCurrentZoom();
NERtcEx.getInstance().setCameraZoomFactor(curZoom + 2); //放大
NERtcEx.getInstance().setCameraZoomFactor(curZoom - 2); //缩小
```

## 摄像头切换

### 配置步骤

- 调用 [`switchCamera`](https://doc.yunxin.163.com/nertc/api-refer/android/doxygen/Latest/zh/html/classcom_1_1netease_1_1lava_1_1nertc_1_1sdk_1_1_n_e_rtc_ex.html#a838797a2fff34447efefc5694cacd9f4) 方法在前置摄像头和后置摄像头之间切换，通话过程中也可随时切换。
- 调用 [`switchCameraWithPosition`](https://doc.yunxin.163.com/nertc/api-refer/android/doxygen/Latest/zh/html/classcom_1_1netease_1_1lava_1_1nertc_1_1sdk_1_1_n_e_rtc_ex.html#a2594628645064b7f87fa9da87c80778b) 方法指定使用前置摄像头（CAMERA_POSITION_FRONT）或后置摄像头（CAMERA_POSITION_BACK），通话过程中也可随时指定。

::: note note
- 若切换摄像头后的最大分辨率不支持设置的编码参数，SDK 会根据设备实际支持的分辨率，调整编码的实际分辨率和对应的实际码率。
- V5.3.0 及之后版本，关闭再开启本地视频采集后，采集的摄像头行为变更，由之前的延用上一次摄像头配置，改为默认采用[`switchCameraWithPosition`](https://doc.yunxin.163.com/nertc/api-refer/android/doxygen/Latest/zh/html/classcom_1_1netease_1_1lava_1_1nertc_1_1sdk_1_1_n_e_rtc_ex.html#a2594628645064b7f87fa9da87c80778b) 接口中指定的前置摄像头或后置摄像头。若在房间内重新开启摄像头采集，请调用 [`switchCamera`](https://doc.yunxin.163.com/nertc/api-refer/android/doxygen/Latest/zh/html/classcom_1_1netease_1_1lava_1_1nertc_1_1sdk_1_1_n_e_rtc_ex.html#a838797a2fff34447efefc5694cacd9f4) 方法重新选择所需要的前置或后置摄像头。
- V5.3.0 及之后版本，子房间支持调用 `NERtcChannel#switchCamera` 或 `NERtcChannel#switchCameraWithPosition` 切换摄像头。

:::

### 示例代码
```
// 切换前后摄像头
NERtcEx.getInstance().switchCamera();
 
//指定前置摄像头
NERtcEx.getInstance().switchCameraWithPosition(NERtcConstants.CameraPosition.CAMERA_POSITION_FRONT);

//指定后置摄像头
NERtcEx.getInstance().switchCameraWithPosition(NERtcConstants.CameraPosition.CAMERA_POSITION_BACK);
```

## 开关闪光灯

### 配置步骤

1. 调用 [`isCameraTorchSupported`](https://doc.yunxin.163.com/nertc/api-refer/android/doxygen/Latest/zh/html/classcom_1_1netease_1_1lava_1_1nertc_1_1sdk_1_1_n_e_rtc_ex.html#ada9931b8cf5701f10c7c1fc6c16adb3e) 方法，检测设备是否支持闪光灯常开。
    ::: note note 
    - 一般情况下，App 默认开启前置摄像头，因此如果设备的前置摄像头不支持闪光灯，直接调用此方法会返回 NO（表示不支持闪光灯常开）。
    - 若您需要检查后置摄像头是否支持闪光灯，需要先调用 [`switchCamera`](https://doc.yunxin.163.com/nertc/api-refer/android/doxygen/Latest/zh/html/classcom_1_1netease_1_1lava_1_1nertc_1_1sdk_1_1_n_e_rtc_ex.html#a838797a2fff34447efefc5694cacd9f4) 方法切换至后置摄像头或调用 [`switchCameraWithPosition`]() 方法指定使用后置摄像头，再调用此方法。
    :::
2. 调用 [`setCameraTorchOn`](https://doc.yunxin.163.com/nertc/api-refer/android/doxygen/Latest/zh/html/classcom_1_1netease_1_1lava_1_1nertc_1_1sdk_1_1_n_e_rtc_ex.html#a13e6437185584c5ad0d58feeef9945ef) 开关闪光灯，通话过程中也可随时开关。


### 示例代码

```
// 检测设备是否支持闪光灯常开
NERtcEx.getInstance().isCameraTorchSupported();

// 开关闪光灯
boolean cameraFlashOn = true;
NERtcEx.getInstance().setCameraTorchOn(cameraFlashOn);
```

## 手动对焦

### 配置步骤

1. 调用 [`isCameraFocusSupported`](https://doc.yunxin.163.com/nertc/api-refer/android/doxygen/Latest/zh/html/classcom_1_1netease_1_1lava_1_1nertc_1_1sdk_1_1_n_e_rtc_ex.html#ae01daa1ce08a7d6b1e4af1c9e33db46b) 方法，检测设备是否支持手动对焦。
2. 调用 [`setCameraFocusPosition`](https://doc.yunxin.163.com/nertc/api-refer/android/doxygen/Latest/zh/html/classcom_1_1netease_1_1lava_1_1nertc_1_1sdk_1_1_n_e_rtc_ex.html#abec3c93e8d2e37b539c74b6dc73e9bdb) 方法设置手动对焦位置并触发对焦。相关参数说明如下：
    - focusX：触摸点相对于视图的横坐标，取值范围为 0 ~ 1。
    - focusY：触摸点相对于视图的纵坐标，取值范围为 0 ~ 1。
    ::: note note
    对焦点区域面积对测光和对焦都有影响，用户应根据需要调整对焦点区域面积。
    :::

### 示例代码

```
// 检测设备是否支持手动对焦
NERtcEx.getInstance().isCameraFocusSupported();

// 设置手动对焦位置
if(event.getAction() == MotionEvent.ACTION_UP){
    NERtcEx.getInstance().setCameraFocusPosition(event.getX(),event.getY());
}   
```

## 手动曝光

### 配置步骤

1. 调用 [`isCameraExposurePositionSupported`](https://doc.yunxin.163.com/nertc/api-refer/android/doxygen/Latest/zh/html/classcom_1_1netease_1_1lava_1_1nertc_1_1sdk_1_1_n_e_rtc_ex.html#a19fd9ce54d3f7eb14473d09afae6252f) 方法，检测设备是否支持手动曝光功能。
2. 调用 [`setCameraExposurePosition`](https://doc.yunxin.163.com/nertc/api-refer/android/doxygen/Latest/zh/html/classcom_1_1netease_1_1lava_1_1nertc_1_1sdk_1_1_n_e_rtc_ex.html#ad3a34c52eede1b9d19429274c1d3a751) 方法设置手动曝光位置并触发曝光。相关参数说明如下：
    - focusX：触摸点相对于视图的横坐标，取值范围为 0 ~ 1。
    - focusY：触摸点相对于视图的纵坐标，取值范围为 0 ~ 1。

### 示例代码

```
// 检测设备是否支持手动曝光
NERtcEx.getInstance().isCameraExposurePositionSupported();

// 设置手动曝光位置
if(event.getAction() == MotionEvent.ACTION_UP){
    NERtcEx.getInstance().setCameraExposurePosition(event.getX(),event.getY());
}   
```

## API 参考
| **方法** | **功能描述**|
|:--|:--|
|[`isCameraZoomSupported`](https://doc.yunxin.163.com/nertc/api-refer/android/doxygen/Latest/zh/html/classcom_1_1netease_1_1lava_1_1nertc_1_1sdk_1_1_n_e_rtc_ex.html#ab91298d417a68719435a2ae0975a72df)|是否支持摄像头缩放|
|[`setCameraZoomFactor`](https://doc.yunxin.163.com/nertc/api-refer/android/doxygen/Latest/zh/html/classcom_1_1netease_1_1lava_1_1nertc_1_1sdk_1_1_n_e_rtc_ex.html#a6395a6b5ff8aaf426740c7e000396195)|设置摄像头缩放比例|
|[`switchCamera`](https://doc.yunxin.163.com/nertc/api-refer/android/doxygen/Latest/zh/html/classcom_1_1netease_1_1lava_1_1nertc_1_1sdk_1_1_n_e_rtc_ex.html#a838797a2fff34447efefc5694cacd9f4)|切换前后置摄像头|
|[`switchCameraWithPosition`](https://doc.yunxin.163.com/nertc/api-refer/android/doxygen/Latest/zh/html/classcom_1_1netease_1_1lava_1_1nertc_1_1sdk_1_1_n_e_rtc_ex.html#a2594628645064b7f87fa9da87c80778b)|指定前后置摄像头|
|[`isCameraTorchSupported`](https://doc.yunxin.163.com/nertc/api-refer/android/doxygen/Latest/zh/html/classcom_1_1netease_1_1lava_1_1nertc_1_1sdk_1_1_n_e_rtc_ex.html#ada9931b8cf5701f10c7c1fc6c16adb3e)|是否支持闪光灯常开|
|[`setCameraTorchOn`](https://doc.yunxin.163.com/nertc/api-refer/android/doxygen/Latest/zh/html/classcom_1_1netease_1_1lava_1_1nertc_1_1sdk_1_1_n_e_rtc_ex.html#a13e6437185584c5ad0d58feeef9945ef)|开关闪光灯|
|[`isCameraFocusSupported`](https://doc.yunxin.163.com/nertc/api-refer/android/doxygen/Latest/zh/html/classcom_1_1netease_1_1lava_1_1nertc_1_1sdk_1_1_n_e_rtc_ex.html#ae01daa1ce08a7d6b1e4af1c9e33db46b)|是否支持手动对焦|
|[`setCameraFocusPosition`](https://doc.yunxin.163.com/nertc/api-refer/android/doxygen/Latest/zh/html/classcom_1_1netease_1_1lava_1_1nertc_1_1sdk_1_1_n_e_rtc_ex.html#abec3c93e8d2e37b539c74b6dc73e9bdb)|设置手动对焦位置|
|[`isCameraExposurePositionSupported`](https://doc.yunxin.163.com/nertc/api-refer/android/doxygen/Latest/zh/html/classcom_1_1netease_1_1lava_1_1nertc_1_1sdk_1_1_n_e_rtc_ex.html#a19fd9ce54d3f7eb14473d09afae6252f)|是否支持手动曝光|
|[`setCameraExposurePosition`](https://doc.yunxin.163.com/nertc/api-refer/android/doxygen/Latest/zh/html/classcom_1_1netease_1_1lava_1_1nertc_1_1sdk_1_1_n_e_rtc_ex.html#ad3a34c52eede1b9d19429274c1d3a751)|设置手动曝光位置|