为了让视频有更好的观看体验，App 往往需要实现视频横竖屏切换、默认竖屏或默认横屏等功能。为防止视频因旋转出现视频画面裁剪、缩放等问题，您可以通过 <a href="https://doc.yunxin.163.com/nertc/api-refer/android/doxygen/Latest/zh/html/classcom_1_1netease_1_1lava_1_1nertc_1_1sdk_1_1_n_e_rtc.html#ac0ae5d451a01fe2510d1c21e909c247a" target="_blank">`setLocalVideoConfig`</a> 的 <a href="https://doc.yunxin.163.com/nertc/api-refer/android/doxygen/Latest/zh/html/classcom_1_1netease_1_1lava_1_1nertc_1_1sdk_1_1video_1_1_n_e_rtc_video_config.html#a0d6f505fccb7594e9637acdbb5eed162" target="_blank">`orientationMode`</a> 参数，设置视频的旋转方向。

## 基本概念

- Status Bar：移动端的系统状态栏。

- UI 锁定：由开发者进行设置。UI 锁定时，即使用户打开屏幕自动旋转，也无法旋转。不锁定时，App 方向将跟随设备旋转。

- 屏幕自动旋转：开启时，App 方向将跟随设备旋转，用户可以在移动端系统控制栏中进行操作。

## 功能原理

采集端采集图像时，同时收集视频的旋转方向模式信息。播放端将接收到的视频图像进行渲染，并旋转方向模式信息对应地旋转视频，以达到和采集端表现一致。

<a href="https://doc.yunxin.163.com/nertc/api-refer/android/doxygen/Latest/zh/html/classcom_1_1netease_1_1lava_1_1nertc_1_1sdk_1_1video_1_1_n_e_rtc_video_config.html#a0d6f505fccb7594e9637acdbb5eed162" target="_blank">`orientationMode`</a> 参数提供了三种模式：

- VIDEO_OUTPUT_ORIENTATION_MODE_ADAPTATIVE（自适应模式）
- VIDEO_OUTPUT_ORIENTATION_MODE_FIXED_PORTRAIT（竖屏模式）
- VIDEO_OUTPUT_ORIENTATION_MODE_FIXED_LANDSCAPE（横屏模式）

具体说明参考下文。

### 自适应模式

该模式下，SDK 输出的视频方向与采集到的视频方向一致。接收端会根据收到的视频旋转信息对视频进行旋转。该模式适用于接收端可以自主调整视频方向的场景。

**UI 锁定或关闭屏幕自动旋转**

Status Bar 与屏幕的位置固定不变，不应重力感应而变化位置。因此视频和屏幕的相对位置，采集端和接收端始终保持一致。

<table>
<tr>
<th><b>采集端</b></th>
<th><b>接收端横屏</b></th>
<th><b>接收端竖屏</b></th>
</tr>
<tr>
<td  style="border: 0px"><img style="width:80%;border: 0px solid #BFBFBF;"src="https://yx-web-nosdn.netease.im/common/4d040e11f0acb0196ff546062e4b9d14/采集端竖屏.png"></td>
<td style="border: 0px"><img style="width:80%;border: 0px solid #BFBFBF;"src="https://yx-web-nosdn.netease.im/common/286d4f61015171e280bbf6118a816660/接收端横屏.png"></td>
<td style="border: 0px"><img style="width:80%;border: 0px solid #BFBFBF;"src="https://yx-web-nosdn.netease.im/common/4d040e11f0acb0196ff546062e4b9d14/采集端竖屏.png"></td>
</tr>
<tr>
<td style="border: 0px"><img style="width:80%;border: 0px solid #BFBFBF;"src="https://yx-web-nosdn.netease.im/common/e8bd7e592d3a719e8de05d943fff8c86/采集端横屏.png"></td>
<td style="border: 0px"><img style="width:80%;border: 0px solid #BFBFBF;"src="https://yx-web-nosdn.netease.im/common/e8bd7e592d3a719e8de05d943fff8c86/采集端横屏.png"></td>
<td style="border: 0px"><img style="width:80%;border: 0px solid #BFBFBF;"src="https://yx-web-nosdn.netease.im/common/a8cb107b6256cf97700672cc0e45a8c2/接收端竖屏.png"></td>
</tr>
</table>

**UI 不锁定或开启屏幕自动旋转**

Status Bar 总是在屏幕的顶端。

<table>
<tr>
<th><b>采集端</b></th>
<th><b>接收端横屏</b></th>
<th><b>接收端竖屏</b></th>
</tr>
<tr>
<td  style="border: 0px"><img style="width:80%;border: 0px solid #BFBFBF;"src="https://yx-web-nosdn.netease.im/common/4d040e11f0acb0196ff546062e4b9d14/采集端竖屏.png"></td>
<td style="border: 0px"><img style="width:80%;border: 0px solid #BFBFBF;"src="https://yx-web-nosdn.netease.im/common/578ebf0ed3950f7ac0eecdd2f7e3737e/竖屏模式接收端横屏2.png"></td>
<td style="border: 0px"><img style="width:80%;border: 0px solid #BFBFBF;"src="https://yx-web-nosdn.netease.im/common/4d040e11f0acb0196ff546062e4b9d14/采集端竖屏.png"></td>
</tr>
<tr>
<td style="border: 0px"><img style="width:80%;border: 0px solid #BFBFBF;"src="https://yx-web-nosdn.netease.im/common/e83f8421b52d3a0d134940d93b5999a8/横屏模式采集端横屏.png"></td>
<td style="border: 0px"><img style="width:80%;border: 0px solid #BFBFBF;"src="https://yx-web-nosdn.netease.im/common/a0e591de9b9206619fb2aa4d6d1663b4/横屏模式接收端横屏.png"></td>
<td style="border: 0px"><img style="width:80%;border: 0px solid #BFBFBF;"src="https://yx-web-nosdn.netease.im/common/06243a468a074119af9fd8ce6cf9a317/横屏模式接收端竖屏.png"></td>
</tr>
</table>

### 竖屏模式

该模式下，SDK 输出的视频相对于 Status Bar 总是处于竖屏模式。如果采集到的视频是横屏，则视频编码器会对视频进行裁剪。

如果采集到的视频是竖屏，则无需裁剪视频。该模式适用于当接收端无法调整视频方向时，例如旁路推流场景。

<table>
<tr>
<th><b>采集端</b></th>
<th><b>接收端横屏</b></th>
<th><b>接收端竖屏</b></th>
</tr>
<tr>
<td  style="border: 0px"><img style="width:80%;border: 0px solid #BFBFBF;"src="https://yx-web-nosdn.netease.im/common/4d040e11f0acb0196ff546062e4b9d14/采集端竖屏.png"></td>
<td style="border: 0px"><img style="width:80%;border: 0px solid #BFBFBF;"src="https://yx-web-nosdn.netease.im/common/578ebf0ed3950f7ac0eecdd2f7e3737e/竖屏模式接收端横屏2.png"></td>
<td style="border: 0px"><img style="width:80%;border: 0px solid #BFBFBF;"src="https://yx-web-nosdn.netease.im/common/4d040e11f0acb0196ff546062e4b9d14/采集端竖屏.png"></td>
</tr>
<tr>
<td style="border: 0px"><img style="width:80%;border: 0px solid #BFBFBF;"src="https://yx-web-nosdn.netease.im/common/b27581610cc6d00dc121eded460c66ae/竖屏模式采集端横屏.png"></td>
<td style="border: 0px"><img style="width:80%;border: 0px solid #BFBFBF;"src="https://yx-web-nosdn.netease.im/common/0af6ae5dc4f92aa8f2059bd9d6208617/竖屏模式接收端横屏.png"></td>
<td style="border: 0px"><img style="width:80%;border: 0px solid #BFBFBF;"src="https://yx-web-nosdn.netease.im/common/4c9997497134b96e000b3b4e96a69a9a/竖屏模式接收端竖屏.png"></td>
</tr>
</table>

### 横屏模式

该模式下，SDK 输出的视频相对于 Status Bar 总是处于横屏模式。如果采集到的视频是竖屏，则视频编码器会对视频进行裁剪。如果采集到的视频是横屏，则无需裁剪视频。

该模式适用于当接收端无法调整视频方向时，例如旁路推流场景。

<table>
<tr>
<th><b>采集端</b></th>
<th><b>接收端横屏</b></th>
<th><b>接收端竖屏</b></th>
</tr>
<tr>
<td  style="border: 0px"><img style="width:80%;border: 0px solid #BFBFBF;"src="https://yx-web-nosdn.netease.im/common/80fd924dfd6aa3cf87ef86321a63ad40/横屏模式采集端竖屏.png"></td>
<td style="border: 0px"><img style="width:80%;border: 0px solid #BFBFBF;"src="https://yx-web-nosdn.netease.im/common/83ec7727a2ec3c873a851e4493d3c0d0/横屏模式接收端横屏2.png"></td>
<td style="border: 0px"><img style="width:80%;border: 0px solid #BFBFBF;"src="https://yx-web-nosdn.netease.im/common/8c0f0ebd3e9146f2abb5ba378e3bf5c5/横屏模式接收端竖屏2.png"></td>
</tr>
<tr>
<td style="border: 0px"><img style="width:80%;border: 0px solid #BFBFBF;"src="https://yx-web-nosdn.netease.im/common/e83f8421b52d3a0d134940d93b5999a8/横屏模式采集端横屏.png"></td>
<td style="border: 0px"><img style="width:80%;border: 0px solid #BFBFBF;"src="https://yx-web-nosdn.netease.im/common/a0e591de9b9206619fb2aa4d6d1663b4/横屏模式接收端横屏.png"></td>
<td style="border: 0px"><img style="width:80%;border: 0px solid #BFBFBF;"src="https://yx-web-nosdn.netease.im/common/06243a468a074119af9fd8ce6cf9a317/横屏模式接收端竖屏.png"></td>
</tr>
</table>

## 注意事项

- 若您集成的是 V4.6.0 之前的版本，设置旋转方向后，只会影响远端用户看到的视频画面。
- 若您集成的是 V4.6.0 及之后的版本，设置旋转方向后，会同时影响本端用户的预览画面和远端用户看到的视频画面。

## 实现 App 为竖屏模式
如果希望 App 界面为竖屏模式，例如微信的视频通话，您可以参考如下步骤：

1. 设置 App UI 默认为竖屏。

    在 `AndroidManifest.xml` 中，设置 `activity` 的 `screenOrientation` 属性为 `portrait`，即可指定该界面为竖屏模式。

    ```XML
    <activity
                android:name=".NERTCMainActivity" android:launchMode="singleTask" android:windowSoftInputMode="adjustPan"
                android:screenOrientation="portrait" /><!--竖屏设置-->
    ```

2. 推流端配置 SDK 使用竖屏模式。

    加入房间前，通过 NERTC SDK 的 <a href="https://doc.yunxin.163.com/nertc/api-refer/android/doxygen/Latest/zh/html/classcom_1_1netease_1_1lava_1_1nertc_1_1sdk_1_1_n_e_rtc.html#ac0ae5d451a01fe2510d1c21e909c247a" target="_blank">`setLocalVideoConfig`</a> 设置视频属性时，将 <a href="https://doc.yunxin.163.com/nertc/api-refer/android/doxygen/Latest/zh/html/classcom_1_1netease_1_1lava_1_1nertc_1_1sdk_1_1video_1_1_n_e_rtc_video_config.html#a0d6f505fccb7594e9637acdbb5eed162" target="_blank">`orientationMode`</a> 参数对值设置为 `VIDEO_OUTPUT_ORIENTATION_MODE_FIXED_PORTRAIT`（竖屏模式）。

3. 拉流端配置 SDK 使用自适应模式。

    加入房间前，通过 NERTC SDK 的 <a href="https://doc.yunxin.163.com/nertc/api-refer/android/doxygen/Latest/zh/html/classcom_1_1netease_1_1lava_1_1nertc_1_1sdk_1_1_n_e_rtc.html#ac0ae5d451a01fe2510d1c21e909c247a" target="_blank">`setLocalVideoConfig`</a> 设置视频属性时，将 <a href="https://doc.yunxin.163.com/nertc/api-refer/android/doxygen/Latest/zh/html/classcom_1_1netease_1_1lava_1_1nertc_1_1sdk_1_1video_1_1_n_e_rtc_video_config.html#a0d6f505fccb7594e9637acdbb5eed162" target="_blank">`orientationMode`</a> 参数对值设置为 `VIDEO_OUTPUT_ORIENTATION_MODE_ADAPTATIVE`（自适应模式）。

## 实现 App 为横屏模式

如果要实现 App 界面为横屏模式，您可以参考如下步骤：

1. 设置 App UI 默认为横屏。

    在 `AndroidManifest.xml` 中，设置 `activity` 的 `screenOrientation` 属性为 `landscape`，即可指定该界面为横屏模式：

    ```XML
    <activity
                android:name=".NERTCMainActivity" android:launchMode="singleTask" android:windowSoftInputMode="adjustPan"
                android:screenOrientation="landscape" /><!--横屏设置-->
    ```

2. 推流端配置 SDK 使用横屏模式。

    加入房间前，通过 NERTC SDK 的 <a href="https://doc.yunxin.163.com/nertc/api-refer/android/doxygen/Latest/zh/html/classcom_1_1netease_1_1lava_1_1nertc_1_1sdk_1_1_n_e_rtc.html#ac0ae5d451a01fe2510d1c21e909c247a" target="_blank">`setLocalVideoConfig`</a> 设置视频属性时，将 <a href="https://doc.yunxin.163.com/nertc/api-refer/android/doxygen/Latest/zh/html/classcom_1_1netease_1_1lava_1_1nertc_1_1sdk_1_1video_1_1_n_e_rtc_video_config.html#a0d6f505fccb7594e9637acdbb5eed162" target="_blank">`orientationMode`</a> 参数对值设置为 `VIDEO_OUTPUT_ORIENTATION_MODE_FIXED_LANDSCAPE`（横屏模式）。

3. 拉流端配置 SDK 使用自适应模式。

    加入房间前，通过 NERTC SDK 的 <a href="https://doc.yunxin.163.com/nertc/api-refer/android/doxygen/Latest/zh/html/classcom_1_1netease_1_1lava_1_1nertc_1_1sdk_1_1_n_e_rtc.html#ac0ae5d451a01fe2510d1c21e909c247a" target="_blank">`setLocalVideoConfig`</a> 设置视频属性时，将 <a href="https://doc.yunxin.163.com/nertc/api-refer/android/doxygen/Latest/zh/html/classcom_1_1netease_1_1lava_1_1nertc_1_1sdk_1_1video_1_1_n_e_rtc_video_config.html#a0d6f505fccb7594e9637acdbb5eed162" target="_blank">`orientationMode`</a> 参数对值设置为 `VIDEO_OUTPUT_ORIENTATION_MODE_ADAPTATIVE`（自适应模式）。