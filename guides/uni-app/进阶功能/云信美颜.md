<!--- keywords：美颜，滤镜，美白，磨皮，瘦脸 -->

NERTC SDK 提供网易云信自研的基础美颜和高级美颜功能，帮助用户在音视频通话或互动直播场景中，对人脸进行美肤、美型等美颜调整，或通过画面滤镜改变视频的色调与氛围。

## 注意事项

调用 <a href="https://doc.yunxin.163.com/nertc/references/uniapp/typedoc/Latest/zh/html/modules/nertc.nertc-1.html#enablelocalvideo" target="_blank">`enableLocalVideo`</a> 开启本地视频采集时，请设置 `streamType` 为 `kNERtcVideoStreamTypeMain`，否则美颜效果不会生效。

## 基础美颜

网易云信基础美颜可免费使用。

网易云信基础美颜支持美白、磨皮、红润和锐化 4 种效果，程度可调节，具体参数如下表所示。

| 分类 | 项 | 枚举值 | 说明 |
| ---- | ---- | ---- | ---- |
| 美肤 | 美白 | kNERtcBeautyWhiten | 强度范围 0~1，默认值为 0，推荐值为 0.80 |
| ^^ | 磨皮 | kNERtcBeautySmooth | 强度范围 0~1，默认值为 0，推荐值为 0.65 |
| ^^ | 红润 | kNERtcBeautyFaceRuddy | 强度范围 0~1，默认值为 0，推荐值为 0.30 |
| ^^ | 锐化 | kNERtcBeautyFaceSharpen | 强度范围 0~1，默认值为 0，推荐值为 0.10 |

基础美颜的实现方法和高级美颜一样，具体步骤请参考 [高级美颜中的实现方法](#实现方法)。

## 高级美颜

网易云信高级美颜提供美白、磨皮、瘦脸、大眼等多种美肤、美型效果。

### 实现方法

NERTC SDK 基础美颜、高级美颜的实现方法如下：

1. 启用美颜模块。

    在开启视频之前，调用 [`startBeauty`](https://doc.yunxin.163.com/nertc/references/uniapp/typedoc/Latest/zh/html/modules/nertc.nertc-1.html#startbeauty) 开启美颜功能模块。开启美颜功能之后才能使用美颜、滤镜等美颜效果。

2. 调整美颜效果。

    您可以调用 [`setBeautyEffect`](https://doc.yunxin.163.com/nertc/references/uniapp/typedoc/Latest/zh/html/modules/nertc.nertc-1.html#setbeautyeffect) 手动设置各种美颜效果，并调整对应的效果强度，具体请参考 [高级美颜枚举值](#高级美颜枚举值)。

   <div style="width:60px">参数</div> | <div style="width:100px">说明</div> |
   ---- | ----
    `beautyType` | 指定美颜效果。目前支持美白、磨皮等美颜效果。 |
    `level` | 指定美颜强度。取值范围为 [0,1]，各种美颜效果的默认值不同。取值越大，美颜强度越大，请根据业务需要自定义设置美颜强度。 |

    ::: note note
    美白、磨皮等美颜效果可以互相叠加，也可以和滤镜效果互相叠加，但是不能同时使用多款滤镜。
    :::

3. （可选）暂停和恢复美颜。

    您可以调用 [`enableBeauty`](https://doc.yunxin.163.com/nertc/references/uniapp/typedoc/Latest/zh/html/modules/nertc.nertc-1.html#enablebeauty)暂停或恢复美颜功能，参数说明如下：

    - false: 暂停美颜。暂停后，所有美颜和滤镜效果都会暂时取消，直至重新启用美颜效果。
    - true: 恢复美颜。

    ::: note notice
    需要先后调用 `startBeauty` 和 `enableBeauty(true)` 接口，美颜特效才会生效。若仅单独调用 `startBeauty`，美颜特效将不会生效。
    :::

4. 结束美颜模块。

    无需使用美颜效果时，需要调用 [`stopBeauty`](https://doc.yunxin.163.com/nertc/references/uniapp/typedoc/Latest/zh/html/modules/nertc.nertc-1.html#stopbeauty) 结束美颜功能模块，此时 SDK 会自动销毁美颜引擎并释放资源。

### <span id="高级美颜枚举值">特效列表</span>

高级美颜目前有 28 种效果，程度可调节，且包含了基础美颜的 4 种效果。

| <div style="width:60x">分类</div> | <div style="width:60px">项</div> | 枚举值 | <div style="width:80px">描述</div> |
| ---- | ---- | ---- | ---- |
| 美肤 | 美白 | kNERtcBeautyWhiten | 强度范围 0~1，默认值为 0，推荐值为 0.80 |
| ^^ | 磨皮 | kNERtcBeautySmooth | 强度范围 0~1，默认值为 0，推荐值为 0.65 |
| ^^ | 红润 | kNERtcBeautyFaceRuddy | 强度范围 0~1，默认值为 0，推荐值为 0.30 |
| ^^ | 锐化 | kNERtcBeautyFaceSharpen | 强度范围 0~1，默认值为 0，推荐值为 0.10 |
| 脸型 | 瘦脸 | kNERtcBeautyThinFace | 强度范围 0~1，默认值为 0，推荐值为 0.35 |
| ^^ | V 脸 | kNERtcBeautyVFace | 强度范围 0~1，默认值为 0，推荐值为 0.00 |
| ^^ | 窄脸 | kNERtcBeautyNarrowFace | 强度范围 0~1，默认值为 0，推荐值为 0.00 |
| ^^ | 小脸 | kNERtcBeautySmallFace | 强度范围 0~1，默认值为 0，推荐值为 0.10 |
| 面部 | 瘦颧骨 | kNERtcBeautyCheekBone | 强度范围 0~1，默认值为 0，推荐值为 0.30 |
| ^^ | 瘦下颌 | kNERtcBeautyUnderJaw | 强度范围 0~1，默认值为 0，推荐值为 0.30 |
| ^^ | 瘦下巴 | kNERtcBeautyJaw | 强度范围 0~1，默认值为 0，推荐值为 0.40 |
| ^^ | 人中调整 | kNERtcBeautyPhiltrum | 强度范围 0~1，默认值为 0.50，推荐值为 0.50 |
| ^^ | 袪抬头纹 | kNERtcBeautyForeheadWrinkles | 强度范围 0~1，默认值为 0，推荐值为 0.30 |
| ^^ | 袪法令纹 | kNERtcBeautySmileLines | 强度范围 0~1，默认值为 0，推荐值为 0.30 |
| ^^ | 短脸 | kNERtcBeautyShortFace | 强度范围 0~1，默认值为 0，推荐值为 0.10 |
| 眼睛 | 大眼 | kNERtcBeautyBigEye | 强度范围 0~1，默认值为 0，推荐值为 0.30 |
| ^^ | 圆眼 | kNERtcBeautyRoundEye | 强度范围 0~1，默认值为 0，推荐值为 0.80 |
| ^^ | 亮眼 | kNERtcBeautyLightEye | 强度范围 0~1，默认值为 0，推荐值为 0.60 |
| ^^ | 开眼角 | kNERtcBeautyEyeCorner | 强度范围 0~1，默认值为 0，推荐值为 0.30 |
| ^^ | 眼距调整 | kNERtcBeautyEyeDis | 强度范围 0~1，默认值为 0.50，推荐值为 0.50 |
| ^^ | 眼角调整 | kNERtcBeautyEyeAngle | 强度范围 0~1，默认值为 0.50，推荐值为 0.50 |
| ^^ | 袪黑眼圈 | kNERtcBeautyDarkCircles | 强度范围 0~1，默认值为 0，推荐值为 0.30 |
| 鼻子 | 小鼻 | kNERtcBeautySmallNose | 强度范围 0~1，默认值为 0，推荐值为 0.40 |
| ^^ | 鼻长调整 | kNERtcBeautyLongNose | 强度范围 0~1，默认值为 0.50，推荐值为 0.50 |
| 嘴巴 | 美牙 | kNERtcBeautyWhiteTeeth | 强度范围 0~1，默认值为 0，推荐值为 0.30 |
| ^^ | 嘴角调整 | kNERtcBeautyMouthAngle | 强度范围 0~1，默认值为 0.50，推荐值为 0.50 |
| ^^ | 嘴型调整 | kNERtcBeautyMouth | 强度范围 0~1，默认值为 0.50，推荐值为 0.50 |
| ^^ | 嘴巴宽度 | kNERtcBeautyMouthWider | 强度范围 0~1，默认值为 0.50，推荐值为 0.50 |

## <span id="滤镜">滤镜</span>

网易云信美颜支持通过美颜资源或模型打造多种个性化的滤镜。

1. 请向网易云信商务经理获取对应的滤镜资源。将滤镜资源放到 `assets` 目录下，App 启动后再把 `assets\filter_portrait` 目录下您需要的滤镜效果拷贝到 SD 卡上，下图以 filter_style_FN1 滤镜为例。

    <img alt="滤镜资源目录.png" src="https://yx-web-nosdn.netease.im/common/2548397654676f59c932bada7b513528/滤镜资源目录.png" style="width:30%;border: 1px solid #BFBFBF;">

2. 启用美颜模块。

    在开启视频之前，调用 [`startBeauty`](https://doc.yunxin.163.com/nertc/references/uniapp/typedoc/Latest/zh/html/modules/nertc.nertc-1.html#startbeauty) 开启美颜功能模块。开启美颜功能之后才能使用美颜、滤镜等美颜效果。

3. 调用 [`addBeautyFilter`](https://doc.yunxin.163.com/nertc/references/uniapp/typedoc/Latest/zh/html/modules/nertc.nertc-1.html#addbeautyfilter) 添加滤镜效果。

    ::: note note
    滤镜效果可以和美颜等效果互相叠加，但是不支持叠加多个滤镜。

    需要更换滤镜时，重复调用 `addBeautyFilter` 接口使用新的滤镜资源即可。
    :::

    <div style="width:60px">参数</div> | <div style="width:100px">说明</div> |
    ---- | ----
    `path` | 指定滤镜模型在 SD 卡上的绝对路径。 |
    `level` | 指定滤镜强度，取值范围为 [0,1]，默认为 0.5。取值越大，滤镜越明显，请根据业务需要自定义设置滤镜强度 |

4. 您可以通过[`setBeautyFilterLevel`](https://doc.yunxin.163.com/nertc/references/uniapp/typedoc/Latest/zh/html/modules/nertc.nertc-1.html#setbeautyfilterlevel) 设置滤镜强度。
5. 不需要使用滤镜效果时，调用 [`removeBeautyFilter`](https://doc.yunxin.163.com/nertc/references/uniapp/typedoc/Latest/zh/html/modules/nertc.nertc-1.html#removebeautyfilter) 移除滤镜。
6. 结束美颜模块。

    无需使用美颜效果时，需要调用 [`stopBeauty`](https://doc.yunxin.163.com/nertc/references/uniapp/typedoc/Latest/zh/html/modules/nertc.nertc-1.html#stopbeauty) 结束美颜功能模块，此时 SDK 会自动销毁美颜引擎并释放资源。

<!---### 美妆

1. 调用 [`addBeautyMakeup`](/docs/interface/NERTC_SDK/V4.2.202/Android/html/classcom_1_1netease_1_1lava_1_1nertc_1_1sdk_1_1_n_e_rtc_ex.html#a607ce31c97e2a152d0670dc2c97a48fe) 添加美妆效果。

    美妆效果可以和美颜、滤镜等效果互相叠加，但是不支持叠加多个美妆效果。需要更换美妆效果时，重复调用此接口使用新的美妆模型即可。

    添加美妆效果时，需要通过 `path` 指定美妆模型所在路径，支持 SD 卡上的绝对路径，或 `asset` 目录下的相对路径。
2. 不需要使用美妆效果时，调用 [`removeBeautyMakeup`](/docs/interface/NERTC_SDK/V4.2.202/Android/html/classcom_1_1netease_1_1lava_1_1nertc_1_1sdk_1_1_n_e_rtc_ex.html#a6864c120dd0488d559d795f0a17eb916) 移除美妆效果。
-->

## 示例代码

```JavaScript
// 1. 准备美颜相关资源
// 将 assets 下的相关资源拷贝到/sdcard/Android/data/your.pkg.name 下

// 2.开启美颜
this.engine.startBeauty();

// 3. 根据需要调用 setBeautyEffect，addBeautyFilter 接口来设置美颜及强度，滤镜效果

//设置美白（推荐 0.6）
this.engine.setBeautyEffect(NERtcBeautyEffectType["kNERtcBeautyWhiten"], 0.6)
//设置磨皮（推荐 0.7）
this.engine.setBeautyEffect(NERtcBeautyEffectType["kNERtcBeautySmooth"], 0.7)
//设置红润（推荐 0.5）
this.engine.setBeautyEffect(NERtcBeautyEffectType["kNERtcBeautyFaceRuddy"], 0.5)

4.滤镜相关

//App 端
//App 设置滤镜需要加载本地滤镜资源文件
let path = '2D/bunny' //支持 SD 卡上的绝对路径，或 asset 目录下的相对路径
this.engine.addBeautyFilter(path);

// 根据需要是否暂停美颜功能，false: 暂停美颜，true: 恢复美颜
//App 端独有，暂停美颜效果后，所有美颜效果都会暂时关闭，直至重新恢复美颜效果
this.engine.enableBeauty(true) //false

//// #ifdef H5
//H5 端独有，设置滤镜效果
/**
    * 滤镜类型。包括：
    * - `ziran`：自然。
    * - `baixi`：白皙。
    * - `fennen`：粉嫩。
    * - `weimei`：唯美。
    * - `langman`：浪漫。
    * - `rixi`：日系。
    * - `landiao`：蓝调。
    * - `qingliang`：清凉。
    * - `huaijiu`：怀旧。
    * - `qingcheng`：青橙。
    * - `wuhou`：午后。
    * - `zhigan`：质感。
    * - `mopian`：默片。
    * - `dianying`：电影。
    * - `heibai`：黑白。
    */
let type = 'baixi' //滤镜种类
let level = 0.3 //滤镜强度
this.engine.setFilter('baixi', 0.3)
//设置为 null，表示关闭滤镜
//this.engine.setFilter(null)
// #endif

// 5. 根据需要设置 filter 强度，App 独有
this.engine.setBeautyFilterLevel(1);

// 6. 最终不再使用美颜功能时，通过 stopBeauty 来结束美颜功能，销毁美颜引擎并释放资源。
this.engine.stopBeauty();
```