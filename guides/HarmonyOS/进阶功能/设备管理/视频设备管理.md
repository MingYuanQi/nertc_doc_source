<!--keywords:音视频通话,摄像头切换,闪光灯,对焦,曝光 -->

在各种视频的业务场景中，用户经常会需要调整设备的摄像头，例如调整曝光、对焦和闪光灯等功能设置，使被摄物体成像清晰、亮度适宜。NERTC SDK 提供整套的摄像头管理方法，以便用户灵活切换前置摄像头、后置摄像头，并对摄像头进行缩放、对焦和曝光等相关配置。

文中部分 API 在 1.0.0 Beta 版本中暂未开放，如果您有相关需求，请联系网易云信技术支持工程师。

## 功能介绍

NERTC SDK 提供相关接口，支持检测拍摄相关设备的能力，例如检测是否支持闪光灯常开等。同时支持多种摄像头相关的设置方法，包括：
- 摄像头相关：
    - 摄像头缩放：支持动态调整缩放比例。
    - 摄像头切换：支持切换或指定前后置摄像头。
- 闪光灯：支持开关闪光灯。
- 对焦：支持手动选择对焦位置，摄像头自动对焦。
- 曝光：支持手动选择曝光区域，摄像头自动曝光。

## 注意事项

- 部分设备可能不支持开启闪光灯或摄像头缩放，直接调用接口调节设备可能会失败。因此用户操作前应先调用相关检测接口，判断当前设备是否支持调整设备的相关设置。
- 请在相机启用后再调用视频设备相关的设置方法，例如在调用 <a href="https://doc.yunxin.163.com/docs/interface/nertc/harmonyos/typedoc/Latest/zh/interfaces/NERtc.NERtc.html#startVideoPreview" target="_blank">`startVideoPreview`</a> 方法或 <a href="https://doc.yunxin.163.com/docs/interface/nertc/harmonyos/typedoc/Latest/zh/interfaces/NERtc.NERtc.html#joinChannel" target="_blank">`joinChannel`</a> 方法后。

## 示例项目源码
网易云信提供 [设备管理的示例项目源码 DeviceManagement](https://github.com/netease-im/Basic-Video-Call/tree/master/Group-Video/NERtcSample-GroupVideoCall-Harmony-Typescript)，您可以参考该源码实现视频设备管理。

## 摄像头缩放

### 配置步骤

1. 调用 [`isCameraZoomSupported`](https://doc.yunxin.163.com/docs/interface/nertc/harmonyos/typedoc/Latest/zh/interfaces/NERtc.NERtc.html#iscamerazoomsupported)，检测设备是否支持摄像头缩放功能。
2. 调用 [`setCameraZoomFactor`](https://doc.yunxin.163.com/docs/interface/nertc/harmonyos/typedoc/Latest/zh/interfaces/NERtc.NERtc.html#setcamerazoomfactor) 方法设置具体需要的缩放比例，可在通话过程中动态调整。

    ::: note note
    在设置需要的摄像头缩放比例前，您可以调用 [`getCameraMaxZoom`](https://doc.yunxin.163.com/docs/interface/nertc/harmonyos/typedoc/Latest/zh/interfaces/NERtc.NERtc.html#getcameramaxzoom) 方法获取设备支持的最大缩放比例或调用 [`getCameraCurrentZoom`](https://doc.yunxin.163.com/docs/interface/nertc/harmonyos/typedoc/Latest/zh/interfaces/NERtc.NERtc.html#getcameracurrentzoom) 方法获取摄像头当前的缩放比例。
    :::

### 示例代码

``` typescript
//检测设备是否支持摄像头缩放
NERtcSDK.getInstance().isCameraZoomSupported()

//获取设备支持的最大缩放比例
NERtcSDK.getInstance().getCameraMaxZoom()

//设置摄像头缩放比例
let curZoom = NERtcSDK.getInstance().getCameraCurrentZoom()
NERtcSDK.getInstance().setCameraZoomFactor(curZoom + 2) //放大
NERtcSDK.getInstance().setCameraZoomFactor(curZoom - 2) //缩小
```

## 摄像头切换

### 配置步骤

调用 [`switchCamera`](https://doc.yunxin.163.com/docs/interface/nertc/harmonyos/typedoc/Latest/zh/interfaces/NERtc.NERtc.html#switchcamera) 方法在前置摄像头和后置摄像头之间切换，通话过程中也可随时切换。

### 示例代码
``` typescript
//切换前后摄像头
NERtcSDK.getInstance().switchCamera()
```

## 开关闪光灯

### 配置步骤

1. 调用 [`isCameraTorchSupported`](https://doc.yunxin.163.com/docs/interface/nertc/harmonyos/typedoc/Latest/zh/interfaces/NERtc.NERtc.html#iscameratorchsupported) 方法，检测设备是否支持闪光灯常开。

    一般情况下，App 默认开启前置摄像头，因此如果设备的前置摄像头不支持闪光灯，直接调用此方法会返回 NO（表示不支持闪光灯常开）。

2. 调用 [`setCameraTorchOn`](https://doc.yunxin.163.com/docs/interface/nertc/harmonyos/typedoc/Latest/zh/interfaces/NERtc.NERtc.html#setcameratorchon) 开关闪光灯，通话过程中也可随时开关。

### 示例代码

``` typescript
//检测设备是否支持闪光灯常开
NERtcSDK.getInstance().isCameraTorchSupported()

//开关闪光灯
let cameraFlashOn = true
NERtcSDK.getInstance().setCameraTorchOn(cameraFlashOn)
```

## 手动对焦

### 配置步骤

1. 调用 [`isCameraFocusSupported`](https://doc.yunxin.163.com/docs/interface/nertc/harmonyos/typedoc/Latest/zh/interfaces/NERtc.NERtc.html#iscamerafocussupported) 方法，检测设备是否支持手动对焦。
2. 调用 [`setCameraFocusPosition`](https://doc.yunxin.163.com/docs/interface/nertc/harmonyos/typedoc/Latest/zh/interfaces/NERtc.NERtc.html#setcamerafocusposition) 方法设置手动对焦位置并触发对焦。相关参数说明如下：
    - focusX：触摸点相对于视图的横坐标，取值范围为 0 ~ 1。
    - focusY：触摸点相对于视图的纵坐标，取值范围为 0 ~ 1。
    ::: note note
    对焦点区域面积对测光和对焦都有影响，用户应根据需要调整对焦点区域面积。
    :::

### 示例代码

``` typescript
// 检测设备是否支持手动对焦
NERtcSDK.getInstance().isCameraFocusSupported()

// 设置手动对焦位置
NERtcSDK.getInstance().setCameraFocusPosition(focusX, focusY)
```

## 手动曝光

### 配置步骤

1. 调用 [`isCameraExposurePositionSupported`](https://doc.yunxin.163.com/docs/interface/nertc/harmonyos/typedoc/Latest/zh/interfaces/NERtc.NERtc.html#iscameraexposurepositionsupported) 方法，检测设备是否支持手动曝光功能。
2. 调用 [`setCameraExposurePosition`](https://doc.yunxin.163.com/docs/interface/nertc/harmonyos/typedoc/Latest/zh/interfaces/NERtc.NERtc.html#setcameraexposureposition) 方法设置手动曝光位置并触发曝光。相关参数说明如下：
    - focusX：触摸点相对于视图的横坐标，取值范围为 0 ~ 1。
    - focusY：触摸点相对于视图的纵坐标，取值范围为 0 ~ 1。

### 示例代码

```typescript
// 检测设备是否支持手动曝光
NERtcSDK.getInstance().isCameraExposurePositionSupported()

// 设置手动曝光位置
NERtcSDK.getInstance().setCameraExposurePosition(exposureX, exposureY)
```

## API 列表

| **方法** | **功能描述** |
| :-- | :-- |
| [`isCameraZoomSupported`](https://doc.yunxin.163.com/docs/interface/nertc/harmonyos/typedoc/Latest/zh/interfaces/NERtc.NERtc.html#iscamerazoomsupported) | 是否支持摄像头缩放 |
| [`setCameraZoomFactor`](https://doc.yunxin.163.com/docs/interface/nertc/harmonyos/typedoc/Latest/zh/interfaces/NERtc.NERtc.html#setcamerazoomfactor) | 设置摄像头缩放比例 |
| [`switchCamera`](https://doc.yunxin.163.com/docs/interface/nertc/harmonyos/typedoc/Latest/zh/interfaces/NERtc.NERtc.html#switchcamera) | 切换前后置摄像头 |
| [`isCameraTorchSupported`](https://doc.yunxin.163.com/docs/interface/nertc/harmonyos/typedoc/Latest/zh/interfaces/NERtc.NERtc.html#iscameratorchsupported) | 是否支持闪光灯常开 |
| [`setCameraTorchOn`](https://doc.yunxin.163.com/docs/interface/nertc/harmonyos/typedoc/Latest/zh/interfaces/NERtc.NERtc.html#setcameratorchon) | 开关闪光灯 |
| [`isCameraFocusSupported`](https://doc.yunxin.163.com/docs/interface/nertc/harmonyos/typedoc/Latest/zh/interfaces/NERtc.NERtc.html#iscamerafocussupported) | 是否支持手动对焦 |
| [`setCameraFocusPosition`](https://doc.yunxin.163.com/docs/interface/nertc/harmonyos/typedoc/Latest/zh/interfaces/NERtc.NERtc.html#setcamerafocusposition) | 设置手动对焦位置 |
| [`isCameraExposurePositionSupported`](https://doc.yunxin.163.com/docs/interface/nertc/harmonyos/typedoc/Latest/zh/interfaces/NERtc.NERtc.html#iscameraexposurepositionsupported) | 是否支持手动曝光 |
| [`setCameraExposurePosition`](https://doc.yunxin.163.com/docs/interface/nertc/harmonyos/typedoc/Latest/zh/interfaces/NERtc.NERtc.html#setcameraexposureposition) | 设置手动曝光位置 |