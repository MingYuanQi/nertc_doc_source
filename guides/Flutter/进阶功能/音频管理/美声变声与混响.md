<!--keywords:音视频通话,美声,变声,音效均衡,混响 -->

在泛娱乐行业的多种强互动场景中，往往需要多种丰富的美化与特效功能提升场景的趣味性、提高互动体验，例如美声、变声与混响功能。在多人语聊或 K 歌房场景中，美声与变声功能可以美化主播或连麦者的声音，混响功能可以让声音更具立体感，提升场景的娱乐氛围，烘托气氛。

## 功能介绍

NERTC SDK 支持设置多种预设的美声与变声音效，您也可以通过设置本地语音音效均衡或混响来达到自定义的人声效果，增加场景气氛。

## <span id="注意事项">注意事项</span>

- <a href="https://doc.yunxin.163.com/nertc/references/flutter/dartdoc/Latest/zh/nertc/NERtcEngine/setAudioEffectPreset.html" target="_blank">`setAudioEffectPreset`</a> 方法和 <a href="https://doc.yunxin.163.com/nertc/references/flutter/dartdoc/Latest/zh/nertc/NERtcEngine/setLocalVoicePitch.html" target="_blank">`setLocalVoicePitch`</a> 互斥，调用了其中任一方法后，另一方法会被重置为默认值。
- 各人声效果相关接口在加入房间前后均可调用。退出房间后，各人声效果相关参数均恢复至默认值。



## <span id="预设人声效果">预设人声效果</span>

NERTC SDK 为您提供多种类型的预设人声效果，以满足您在不同场景下的美声与变声需求。

### **美声效果**

美声指声音的美化，即调整人声的音色，例如让声音更加低沉、圆润或清澈。另外，NERTC 的预设美声效果还可以实现场景空间环境的效果塑造，即营造场景化的空间氛围，使人声听起来像是处于特定的空间或场所。

调用 <a href="https://doc.yunxin.163.com/nertc/references/flutter/dartdoc/Latest/zh/nertc/NERtcEngine/setVoiceBeautifierPreset.html" target="_blank">`setVoiceBeautifierPreset`</a> 方法可以使用 SDK 预设的美声效果。目前支持以下预设的美声效果：

<table> 
<tr> 
<th width=30%><b>枚举值</b></th> 
<th width=30%><b>描述</b></th> 
</tr> 
<tr> 
<td>off</td> 
<td>（默认）关闭美声效果。</td> 
</tr> 
<tr> 
<td>muffled</td> 
<td>低沉。</td> 
</tr> 
<tr> 
<td>mellow</td> 
<td>圆润。</td> 
</tr> 
<tr> 
<td>clear</td> 
<td>清澈。</td> 
</tr> 
<tr> 
<td>magneti</td> 
<td>磁性。</td> 
</tr> 
<tr> 
<td>recordingStudio</td> 
<td>录音棚。</td> 
</tr> 
<tr> 
<td>nature</td> 
<td>天籁。</td> 
</tr> 
<tr> 
<td>ktv</td> 
<td>KTV。</td> 
</tr> 
<tr> 
<td>remote</td> 
<td>悠远。</td> 
</tr> 
<tr> 
<td>church</td> 
<td>教堂。</td> 
</tr> 
<tr> 
<td>bedroom</td> 
<td>卧室。</td> 
</tr> 
<tr> 
<td>live</td> 
<td>Live。</td> 
</tr> 
</table>

预设美声效果的**示例代码**如下：

```
//以设置美声效果为预设的低沉为例
int preset = NERtcVoiceBeautifierType.muffled;
int ret = await _engine.setVoiceBeautifierPreset(preset);
```

### **变声效果**

变声指转变人声的特质，例如让声音听起来像机器人、萝莉或具有其它的搞怪效果。

调用 <a href="https://doc.yunxin.163.com/nertc/references/flutter/dartdoc/Latest/zh/nertc/NERtcEngine/setAudioEffectPreset.html" target="_blank">`setAudioEffectPreset`</a> 方法可以使用 SDK 预设的变声效果。目前支持以下预设的变声效果：

<table>
    <tr>
        <th width=30%><b>枚举值</b></th>
        <th width=30%><b>描述</b></th>
    </tr>
    <tr>
        <td>off</td>
        <td>（默认）关闭变声音效。</td>
    </tr>
    <tr>
        <td>robot</td>
        <td>机器人。 </td>
    </tr>
    <tr>
        <td>giant </td>
        <td>巨人。 </td>
    </tr>
    <tr>
        <td>horror </td>
        <td>恐怖。</td>
    </tr>
    <tr>
        <td>mature</td>
        <td>成熟。 </td>
    </tr>
    <tr>
        <td>manToWoman </td>
        <td>男变女。 </td>
    </tr>
    <tr>
        <td>womanToMan </td>
        <td>女变男。</td>
    </tr>
    <tr>
        <td>manToLoli</td>
        <td>男变萝莉。 </td>
    </tr>
    <tr>
        <td>womanToLoli </td>
        <td>女变萝莉。</td>
    </tr>
</table>

预设变声效果的**示例代码**如下：

```
//以设置变声效果为预设的机器人为例
int preset = NERtcVoiceChangerType.robot;
int ret = await _engine.setAudioEffectPreset(preset);
```

### API 参考

| **方法** | **功能描述**|
|:--|:--|
|<a href="https://doc.yunxin.163.com/nertc/references/flutter/dartdoc/Latest/zh/nertc/NERtcEngine/setVoiceBeautifierPreset.html" target="_blank">`setVoiceBeautifierPreset`</a>|设置预设的美声效果|
|<a href="https://doc.yunxin.163.com/nertc/references/flutter/dartdoc/Latest/zh/nertc/NERtcEngine/setAudioEffectPreset.html" target="_blank">`setAudioEffectPreset`</a>|设置预设的变声效果|

## <span id="自定义人声效果">自定义人声效果</span>

如果以上美声与变声效果无法满足您的需求，您也可以通过音调、音效均衡和混响，实现自定义的人声效果。

### **设置音调**

调用 <a href="https://doc.yunxin.163.com/nertc/references/flutter/dartdoc/Latest/zh/nertc/NERtcEngine/setLocalVoicePitch.html" target="_blank">`setLocalVoicePitch`</a> 方法可以设置本地语音音调，例如将音调调高或者调低。调用此方法时，您需要通过设置 `pitch` 参数调整语音频率。该参数的取值范围为 0.5 ~ 2.0，取值越小表示音调越低；默认值为 1.0，表示不需要修改音调。

设置语音音调的**示例代码**如下：

```
//设置语音音调
double pitch = 0.6; //pitch 输入pitch区间在[0.5，2] ，默认值为1
int ret = await _engine.setLocalVoicePitch(pitch);
```

### **设置音效均衡**

调用 <a href="https://doc.yunxin.163.com/nertc/references/flutter/dartdoc/Latest/zh/nertc/NERtcEngine/setLocalVoiceEqualization.html" target="_blank">`setLocalVoiceEqualization`</a> 方法可以设置本地语音音效均衡，即自定义设置本地人声均衡波段的中心频率。调用此方法时，您需要设置 `bandFrequency` 和 `bandGain` 参数，相关参数的说明如下：

- `bandFrequency`：频谱子带索引。该参数的单位为赫兹（Hz），取值范围为 0 ~ 9，分别代表 10 个频带，对应的中心频率分别为 31、62、125、250、500、1k、2k、4k、8k 和 16k。
- `bandGain`：每个频带的增益。该参数的单位为分贝（dB），每个频带对应的增益取值范围为 -15 ~ 15，默认值为 0。

设置语音音效均衡的**示例代码**如下：

```
//设置本地语音音效均衡
int gain = 10 //  取值范围是[-15，15]，默认值为 0
int bandFrequency = 5;
int ret = await _engine.setLocalVoiceEqualization(bandFrequency,gain);
```

### **设置混响**

混响指赋予声音一定立体效果，让声音如同在山洞、音乐厅等场景中发出一般，通常会让声音变得更加饱满、动听。

调用 <a href="https://doc.yunxin.163.com/nertc/references/flutter/dartdoc/Latest/zh/nertc/NERtcEngine/setLocalVoiceReverbParam.html" target="_blank">`setLocalVoiceReverbParam`</a> 方法可以设置本地语音混响，即自定义设置本地人声的混响回声效果。相关参数的说明如下：

- wetGain：湿信号增益。该参数的单位为分贝（dB），取值范围为 0 ~ 1，默认值为 0.0。
- dryGain：干信号增益。该参数的单位为分贝（dB），取值范围为 0 ~ 1，默认值为 1.0。
- damping：混响阻尼，用于设置混响的衰减程度，阻尼越大表示衰减越大。取值范围为 0 ~ 1，默认值为 1.0。
- roomSize：房间大小，用于设置模拟的“房间”大小，房间越大表示混响越强。取值范围为 0.1 ~ 2，默认值为 0.1。
- decayTime：持续强度，用于设置混响的拖尾长度。该参数的单位为秒，取值范围为 0.1 ~ 20，默认值为 0.1。
- preDelay：延迟长度。该参数的单位为秒，取值范围为 0 ~ 1，默认值为 0.0。

设置混响效果的**示例代码**如下：

```
//设置混响效果
NERtcReverbParam param = NERtcReverbParam();
param.wetGain = 0;       
param.dryGain = 1.0;        
param.damping = 0;        
param.decayTime = 0.1;    
param.roomSize = 0.1;    
param.preDelay = 0;        
int ret = await _engine.setLocalVoiceReverbParam(param);
```

### API 参考

| **方法** | **功能描述**|
|:--|:--|
|<a href="https://doc.yunxin.163.com/nertc/references/flutter/dartdoc/Latest/zh/nertc/nertc/NERtcEngine/setLocalVoicePitch.html" target="_blank">`setLocalVoicePitch`</a>|设置本地语音音调|
|<a href="https://doc.yunxin.163.com/nertc/references/flutter/dartdoc/Latest/zh/nertc/NERtcEngine/setLocalVoiceEqualization.html" target="_blank">`setLocalVoiceEqualization`</a>|设置本地语音音效均衡|
|<a href="https://doc.yunxin.163.com/nertc/references/flutter/dartdoc/Latest/zh/nertc/NERtcEngine/setLocalVoiceReverbParam.html" target="_blank">`setLocalVoiceReverbParam`</a>|设置本地语音混响|



