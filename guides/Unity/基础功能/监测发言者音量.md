<!--keywords: 音视频通话,监测发言者音量,人声 -->

在语音连麦、视频会议等场景中，开发者应用层常常需要了解到发言者的人声相关信息，从而做出 UI 上的音量展示或根据发言者的音量大小进行视图布局的动态调整。

<img style="width:400px" src=" https://yx-web-nosdn.netease.im/common/6e7f514baa00ca5efbfb3f2c31cf7d74/音量提示.png " alt="文本">

NERTC SDK 提供监听房间内用户发送的音量值的功能。

## 功能介绍
NERTC SDK 支持根据您设置的时间间隔，定期通过回调返回本端发流用户的瞬时音量值，同时返回最多三位瞬时音量最高的远端用户的相关音量信息，即当前正在发言的用户 ID 和用户音频主流的瞬时音量值。

## 注意事项
- 若本端用户调用 <a href="https://doc.yunxin.163.com/nertc/api-refer/unity/doxygen/Latest/zh/html/classnertc_1_1_i_rtc_engine.html#a8446bce7b7e3b391e3dc266757872ff3" target="_blank">`MuteLocalAudioStream`</a> 方法静音本地音频，SDK 会将音量设置为 0 后通过 <a href="https://doc.yunxin.163.com/nertc/api-refer/unity/doxygen/Latest/zh/html/namespacenertc.html#acab2a4858eecd7b7f61b0a792d23c353" target="_blank">`OnLocalAudioVolumeIndication`</a> 回调返回静音信息，但此回调默认禁用，只可通过 <a href="https://doc.yunxin.163.com/nertc/api-refer/unity/doxygen/Latest/zh/html/classnertc_1_1_i_rtc_engine.html#a4f0d9f3cf3e914b34c4a8184c00a9a92" target="_blank">`EnableAudioVolumeIndication`</a> 方法开启。
- 成功启用人声监测功能后，无论房间内是否有人发言，SDK 都会按指定的时间间隔触发 <a href="https://doc.yunxin.163.com/nertc/api-refer/unity/doxygen/Latest/zh/html/namespacenertc.html#acab2a4858eecd7b7f61b0a792d23c353" target="_blank">`OnLocalAudioVolumeIndication`</a> 和 <a href="https://doc.yunxin.163.com/nertc/api-refer/unity/doxygen/Latest/zh/html/namespacenertc.html#a1dd69b9b8bc16b6cecfa13bcae4747d0" target="_blank">`OnRemoteAudioVolumeIndication`</a> 回调。
- 返回的 <a href="https://doc.yunxin.163.com/nertc/api-refer/unity/doxygen/Latest/zh/html/namespacenertc.html#a1dd69b9b8bc16b6cecfa13bcae4747d0" target="_blank">`OnRemoteAudioVolumeIndication`</a> 回调中，若 `speakers` 数组为空，则表示此时远端没有上行的音频主流数据；若上次返回的数组中出现的 uid 不在本次返回的数组中，则默认该 uid 对应的远端用户没有发言。

## 实现方法 

### **配置步骤**

1. 调用 <a href="https://doc.yunxin.163.com/nertc/api-refer/unity/doxygen/Latest/zh/html/classnertc_1_1_i_rtc_engine.html#a4f0d9f3cf3e914b34c4a8184c00a9a92" target="_blank">`EnableAudioVolumeIndication`</a> 方法，启用发言者的人声监测。
    ::: note note
    音量提示的时间间隔值必须设置为 100 毫秒的整数倍，建议设置为 200 毫秒及以上。
    :::
2. 成功启用人声监测功能后，SDK 返回以下回调通知：
    - <a href="https://doc.yunxin.163.com/nertc/api-refer/unity/doxygen/Latest/zh/html/namespacenertc.html#acab2a4858eecd7b7f61b0a792d23c353" target="_blank">`OnLocalAudioVolumeIndication`</a>：房间内本地用户瞬时音量的回调。
    - <a href="https://doc.yunxin.163.com/nertc/api-refer/unity/doxygen/Latest/zh/html/namespacenertc.html#a1dd69b9b8bc16b6cecfa13bcae4747d0" target="_blank">`OnRemoteAudioVolumeIndication`</a>：房间内正在发言的用户 ID 及用户音频主流的瞬时音量的回调。

### **示例代码**

```C#
//音量监测
private void enableAudioVolumeIndication()
{
    //开启音量监测
    rtcEngine.OnLocalAudioVolumeIndication = EngineOnLocalAudioVolumeIndication;
    rtcEngine.OnRemoteAudioVolumeIndication = EngineOnRemoteAudioVolumeIndication;
    rtcEngine.EnableAudioVolumeIndication(true, 1000);

    //关闭音量监测
    rtcEngine.EnableAudioVolumeIndication(false, 0);
}

private void EngineOnRemoteAudioVolumeIndication(RtcAudioVolumeInfo[] speakers, int totalVolume)
{
    //
}

private void EngineOnLocalAudioVolumeIndication(int volume)
{
    //
}
```

## API 参考
| **方法** | **功能描述**|
|:--|:--|
|<a href="https://doc.yunxin.163.com/nertc/api-refer/unity/doxygen/Latest/zh/html/classnertc_1_1_i_rtc_engine.html#a4f0d9f3cf3e914b34c4a8184c00a9a92" target="_blank">`EnableAudioVolumeIndication`</a>|启用发言者的人声监测|
|<a href="https://doc.yunxin.163.com/nertc/api-refer/unity/doxygen/Latest/zh/html/namespacenertc.html#acab2a4858eecd7b7f61b0a792d23c353" target="_blank">`OnLocalAudioVolumeIndication`</a>|房间内本地用户瞬时音量的回调|
|<a href="https://doc.yunxin.163.com/nertc/api-refer/unity/doxygen/Latest/zh/html/namespacenertc.html#a1dd69b9b8bc16b6cecfa13bcae4747d0" target="_blank">`OnRemoteAudioVolumeIndication`</a>|房间内正在发言的用户 ID 及用户瞬时音量的回调|